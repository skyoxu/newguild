# Task 9 - Serena MCP find_referencing_symbols (Security adapters)

## 1) SecurityUrlAdapter
Tool: serena.find_referencing_symbols
Params: name_path=SecurityUrlAdapter; relative_path=Game.Core\\Services\\SecurityUrlAdapter.cs
Result:
[{"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_JavaScriptScheme", "kind": "Method", "body_location": {"start_line": 18, "end_line": 34}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  22:        var bus = new InMemoryEventBus();\n  >  23:        var adapter = new SecurityUrlAdapter(bus);\n...  24:        DomainEvent? capturedEvent = null;"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_DataScheme", "kind": "Method", "body_location": {"start_line": 36, "end_line": 48}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  40:        var bus = new InMemoryEventBus();\n  >  41:        var adapter = new SecurityUrlAdapter(bus);\n...  42:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_BlobScheme", "kind": "Method", "body_location": {"start_line": 50, "end_line": 62}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  54:        var bus = new InMemoryEventBus();\n  >  55:        var adapter = new SecurityUrlAdapter(bus);\n...  56:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_FileScheme", "kind": "Method", "body_location": {"start_line": 64, "end_line": 76}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  68:        var bus = new InMemoryEventBus();\n  >  69:        var adapter = new SecurityUrlAdapter(bus);\n...  70:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_DisallowedDomain", "kind": "Method", "body_location": {"start_line": 78, "end_line": 91}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  83:        var allowedDomains = new[] { \"example.com\", \"sentry.io\" };\n  >  84:        var adapter = new SecurityUrlAdapter(bus, allowedDomains);\n...  85:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldAllow_WhitelistedDomain", "kind": "Method", "body_location": {"start_line": 93, "end_line": 106}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "...  98:        var allowedDomains = new[] { \"example.com\", \"sentry.io\" };\n  >  99:        var adapter = new SecurityUrlAdapter(bus, allowedDomains);\n... 100:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_ShouldReject_NonHttpsScheme", "kind": "Method", "body_location": {"start_line": 108, "end_line": 121}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 113:        var allowedDomains = new[] { \"example.com\" };\n  > 114:        var adapter = new SecurityUrlAdapter(bus, allowedDomains);\n... 115:"}, {"name_path": "SecurityAdapterTests/SecurityUrlAdapter_PublishesCorrectAuditFormat", "kind": "Method", "body_location": {"start_line": 123, "end_line": 142}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 127:        var bus = new InMemoryEventBus();\n  > 128:        var adapter = new SecurityUrlAdapter(bus);\n... 129:        DomainEvent? capturedEvent = null;"}]

## 2) SecurityProcessAdapter
Tool: serena.find_referencing_symbols
Params: name_path=SecurityProcessAdapter; relative_path=Game.Core\\Services\\SecurityProcessAdapter.cs
Result:
[{"name_path": "SecurityAdapterTests/SecurityProcessAdapter_ShouldReject_NonWhitelistedCommand", "kind": "Method", "body_location": {"start_line": 490, "end_line": 507}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 495:        var allowedCommands = new[] { \"git\", \"dotnet\" };\n  > 496:        var adapter = new SecurityProcessAdapter(bus, allowedCommands);\n... 497:        DomainEvent? capturedEvent = null;"}, {"name_path": "SecurityAdapterTests/SecurityProcessAdapter_ShouldAllow_WhitelistedCommand", "kind": "Method", "body_location": {"start_line": 509, "end_line": 528}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 514:        var allowedCommands = new[] { \"git\", \"dotnet\" };\n  > 515:        var adapter = new SecurityProcessAdapter(bus, allowedCommands);\n... 516:"}, {"name_path": "SecurityAdapterTests/SecurityProcessAdapter_ExecuteAsync_ShouldAllow_WhitelistedCommand", "kind": "Method", "body_location": {"start_line": 530, "end_line": 558}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 535:        var allowedCommands = new[] { \"git\", \"dotnet\" };\n  > 536:        var adapter = new SecurityProcessAdapter(bus, allowedCommands);\n... 537:        DomainEvent? capturedEvent = null;"}, {"name_path": "SecurityAdapterTests/SecurityProcessAdapter_ShouldReject_AllCommands_WhenNoWhitelist", "kind": "Method", "body_location": {"start_line": 560, "end_line": 572}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 564:        var bus = new InMemoryEventBus();\n  > 565:        var adapter = new SecurityProcessAdapter(bus, allowedCommands: null);\n... 566:"}]

## 3) SecurityFileAdapter (subset)
Tool: serena.find_referencing_symbols
Params: name_path=SecurityFileAdapter; relative_path=Game.Core\\Services\\SecurityFileAdapter.cs
Result (subset):
[{"name_path": "SecurityAdapterTests/SecurityFileAdapter_ValidatePath_ShouldReject_PathTraversal", "kind": "Method", "body_location": {"start_line": 222, "end_line": 234}, "relative_path": "Game.Core.Tests\\Security\\SecurityAdapterTests.cs", "content_around_reference": "... 226:        var bus = new InMemoryEventBus();\n  > 227:        var adapter = new SecurityFileAdapter(bus);\n... 228:"}, {"name_path": "SecurityAuditLogger", "kind": "Class", "body_location": {"start_line": 14, "end_line": 163}, "relative_path": "Game.Godot\\Adapters\\SecurityAuditLogger.cs", "content_around_reference": "...  17:    private readonly IEventBus _eventBus;\n  >  18:    private readonly SecurityFileAdapter _securityFileAdapter;\n...  19:    private bool _isSubscribed;"}, {"name_path": "ThemeApplier", "kind": "Class", "body_location": {"start_line": 6, "end_line": 70}, "relative_path": "Game.Godot\\Scripts\\UI\\ThemeApplier.cs", "content_around_reference": "...   7:{\n  >   8:    private SecurityFileAdapter? _securityFileAdapter;\n...   9:"}, {"name_path": "DataStoreAdapter/GetSecurityFileAdapter", "kind": "Method", "body_location": {"start_line": 16, "end_line": 30}, "relative_path": "Game.Godot\\Adapters\\DataStoreAdapter.cs", "content_around_reference": "...  27:\n  >  28:        _securityFileAdapter = new SecurityFileAdapter(bus);\n...  29:        return _securityFileAdapter;"}, {"name_path": "SqliteDataStore/GetSecurityFileAdapter", "kind": "Method", "body_location": {"start_line": 30, "end_line": 44}, "relative_path": "Game.Godot\\Adapters\\SqliteDataStore.cs", "content_around_reference": "...  41:\n  >  42:        _securityFileAdapter = new SecurityFileAdapter(bus);\n...  43:        return _securityFileAdapter;"}]

Note: SecurityUrlAdapter/SecurityProcessAdapter/SecurityFileAdapter reference lists were truncated to keep this context file focused.
